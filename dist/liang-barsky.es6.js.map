{"version":3,"file":"liang-barsky.es6.js","sources":["../src/index.js"],"sourcesContent":["/**\n * @preserve\n * Fast, destructive implemetation of Liang-Barsky line clipping algorithm.\n * It clips a 2D segment by a rectangle.\n * @author Alexander Milevski <info@w8r.name>\n * @license MIT\n */\n\nconst EPSILON = 1e-6;\nconst { abs } = Math;\nconst INSIDE  = 1;\nconst OUTSIDE = 0;\n\n\nfunction clipT(num, denom, c) {\n  var [tE, tL] = c;\n  if (abs(denom) < EPSILON) return num < 0;\n  var t = num / denom;\n\n  if (denom > 0) {\n    if (t > tL) return 0;\n    if (t > tE) c[0] = t;\n  } else {\n    if (t < tE) return 0;\n    if (t < tL) c[1] = t;\n  }\n  return 1;\n}\n\n\n/**\n * @param  {Array<number>} a\n * @param  {Array<number>} b\n * @param  {Array<number>} box [xmin, ymin, xmax, ymax]\n * @return {number}\n */\nexport default function clip(a, b, box) {\n  var [x1, y1] = a;\n  var [x2, y2] = b;\n  var dx = x2 - x1;\n  var dy = y2 - y1;\n\n  if (abs(dx) < EPSILON && abs(dy) < EPSILON &&\n      x1 >= box[0] && x1 <= box[2] &&\n      y1 >= box[1] && y1 <= box[3]) {\n    return INSIDE;\n  }\n\n  var c = [0, 1];\n  if (clipT(box[0] - x1,  dx, c) &&\n      clipT(x1 - box[2], -dx, c) &&\n      clipT(box[1] - y1,  dy, c) &&\n      clipT(y1 - box[3], -dy, c)) {\n    var [tE, tL] = c;\n    if (tL < 1) {\n      b[0] = (x1 + tL * dx);\n      b[1] = (y1 + tL * dy);\n    }\n    if (tE > 0) {\n      a[0] += tE * dx;\n      a[1] += tE * dy;\n    }\n    return INSIDE;\n  }\n  return OUTSIDE;\n}\n"],"names":["const"],"mappings":"AAAA;;;;;;;;AAQAA,IAAM,OAAO,GAAG,IAAI,CAAC;AACrB,IAAQ,GAAG,YAAL;AACNA,IAAM,MAAM,IAAI,CAAC,CAAC;AAClBA,IAAM,OAAO,GAAG,CAAC,CAAC;;;AAGlB,SAAS,KAAK,CAAC,GAAG,EAAE,KAAK,EAAE,CAAC,EAAE;EAC5B,IAAK,EAAE;EAAE,IAAA,EAAE,QAAP;EACJ,IAAI,GAAG,CAAC,KAAK,CAAC,GAAG,OAAO,EAAE,EAAA,OAAO,GAAG,GAAG,CAAC,CAAC,EAAA;EACzC,IAAI,CAAC,GAAG,GAAG,GAAG,KAAK,CAAC;;EAEpB,IAAI,KAAK,GAAG,CAAC,EAAE;IACb,IAAI,CAAC,GAAG,EAAE,EAAE,EAAA,OAAO,CAAC,CAAC,EAAA;IACrB,IAAI,CAAC,GAAG,EAAE,EAAE,EAAA,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,EAAA;GACtB,MAAM;IACL,IAAI,CAAC,GAAG,EAAE,EAAE,EAAA,OAAO,CAAC,CAAC,EAAA;IACrB,IAAI,CAAC,GAAG,EAAE,EAAE,EAAA,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,EAAA;GACtB;EACD,OAAO,CAAC,CAAC;CACV;;;;;;;;;AASD,AAAe,SAAS,IAAI,CAAC,CAAC,EAAE,CAAC,EAAE,GAAG,EAAE;EACtC,IAAK,EAAE;EAAE,IAAA,EAAE,QAAP;EACJ,IAAK,EAAE;EAAE,IAAA,EAAE,QAAP;EACJ,IAAI,EAAE,GAAG,EAAE,GAAG,EAAE,CAAC;EACjB,IAAI,EAAE,GAAG,EAAE,GAAG,EAAE,CAAC;;EAEjB,IAAI,GAAG,CAAC,EAAE,CAAC,GAAG,OAAO,IAAI,GAAG,CAAC,EAAE,CAAC,GAAG,OAAO;MACtC,EAAE,IAAI,GAAG,CAAC,CAAC,CAAC,IAAI,EAAE,IAAI,GAAG,CAAC,CAAC,CAAC;MAC5B,EAAE,IAAI,GAAG,CAAC,CAAC,CAAC,IAAI,EAAE,IAAI,GAAG,CAAC,CAAC,CAAC,EAAE;IAChC,OAAO,MAAM,CAAC;GACf;;EAED,IAAI,CAAC,GAAG,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;EACf,IAAI,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,GAAG,EAAE,GAAG,EAAE,EAAE,CAAC,CAAC;MAC1B,KAAK,CAAC,EAAE,GAAG,GAAG,CAAC,CAAC,CAAC,EAAE,CAAC,EAAE,EAAE,CAAC,CAAC;MAC1B,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,GAAG,EAAE,GAAG,EAAE,EAAE,CAAC,CAAC;MAC1B,KAAK,CAAC,EAAE,GAAG,GAAG,CAAC,CAAC,CAAC,EAAE,CAAC,EAAE,EAAE,CAAC,CAAC,EAAE;IAC9B,IAAK,EAAE;IAAE,IAAA,EAAE,QAAP;IACJ,IAAI,EAAE,GAAG,CAAC,EAAE;MACV,CAAC,CAAC,CAAC,CAAC,IAAI,EAAE,GAAG,EAAE,GAAG,EAAE,CAAC,CAAC;MACtB,CAAC,CAAC,CAAC,CAAC,IAAI,EAAE,GAAG,EAAE,GAAG,EAAE,CAAC,CAAC;KACvB;IACD,IAAI,EAAE,GAAG,CAAC,EAAE;MACV,CAAC,CAAC,CAAC,CAAC,IAAI,EAAE,GAAG,EAAE,CAAC;MAChB,CAAC,CAAC,CAAC,CAAC,IAAI,EAAE,GAAG,EAAE,CAAC;KACjB;IACD,OAAO,MAAM,CAAC;GACf;EACD,OAAO,OAAO,CAAC;CAChB;;"}